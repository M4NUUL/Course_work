# Лабораторная работа — БД СПО «Колибри»

Данный проект представляет собой реализацию базы данных для СПО «Колибри» с использованием PostgreSQL.  
Все взаимодействие с базой данных осуществляется через консоль PostgreSQL (`psql`) без использования логики на C++.

---

## Требования

PostgreSQL 12+  
Пользователь БД: m4nuul  
База данных: kolibri_db  
CSV-файл: spo_kolibri.csv  

---

## Структура проекта

s2_l6/  
├── sql/  
│   ├── 01_schema.sql  
│   ├── 02_import_stage.sql  
│   ├── 03_normalize.sql  
│   ├── 10_add.sql  
│   ├── 20_find_fio.sql  
│   ├── 30_find_phone.sql  
│   ├── 40_inn_by_snils.sql  
│   └── 50_delete.sql  
├── spo_kolibri.csv  
└── README.md  

---

## Проверка подключения к базе данных

Команда:
psql -U m4nuul -d kolibri_db -c "SELECT current_user;"

Описание:
*Проверяет корректность подключения к базе данных.*

---

## Создание структуры базы данных

Команда:
psql -U m4nuul -d kolibri_db -f sql/01_schema.sql

Описание:
*Создаёт схему kolibri, таблицы, типы данных и индексы.*

---

## Загрузка данных из CSV

Команда:
psql -U m4nuul -d kolibri_db -v csv='/home/m4nuul/Coding/s2_l6/spo_kolibri.csv' -f sql/02_import_stage.sql

Описание:
*Загружает данные из CSV-файла в промежуточную таблицу person_import.*

Команда:
psql -U m4nuul -d kolibri_db -f sql/03_normalize.sql

Описание:
*Нормализует данные и переносит их в основные таблицы базы данных.*

---

## Добавление данных

Команда:
psql -U m4nuul -d kolibri_db -v last="Иванов" -v first="Иван" -v middle="Иванович" -v birth="2001-02-03" -v citizenship="РФ" -v org="НГТУ" -v faculty="ФПМИ" -v snils="123-456-789 00" -v inn="123456789012" -v phone="+79998887766" -v last_edu="Аттестат" -v squad="1" -v prof="да" -v member="да" -f sql/10_add.sql

Описание:
*Добавляет нового человека в базу данных с использованием SQL-операторов INSERT.*

---

## Поиск данных по ФИО

Команда:
psql -U m4nuul -d kolibri_db -v last="Иванов" -v first="Иван" -v middle="Иванович" -f sql/20_find_fio.sql

Описание:
*Возвращает все данные о человеке на основе ФИО.*

---

## Поиск ФИО по номеру телефона

Команда:
psql -U m4nuul -d kolibri_db -v phone="+79998887766" -f sql/30_find_phone.sql

Описание:
*Позволяет найти человека по номеру телефона.*

---

## Поиск ИНН по СНИЛС

Команда:
psql -U m4nuul -d kolibri_db -v snils="123-456-789 00" -f sql/40_inn_by_snils.sql

Описание:
*Возвращает ИНН по заданному СНИЛС.*

---

## Удаление данных

Команда:
psql -U m4nuul -d kolibri_db -v id=52 -f sql/50_delete.sql

Описание:
*Удаляет человека по идентификатору person_id. Все связанные данные удаляются каскадно.*

---

## Полезные команды PostgreSQL

Команда:
psql -U m4nuul -d kolibri_db

Описание:
*Вход в интерактивный режим PostgreSQL.*

Команда:
\dt kolibri.*

Описание:
*Просмотр списка таблиц в схеме kolibri.*

Команда:
\q

Описание:
*Выход из PostgreSQL.*

---

## Выход из режима (END)

Если после выполнения команды появляется надпись (END), значит результат открыт в режиме просмотра.

Команда:
q

Описание:
*Выход из режима просмотра (pager / less).*

---

## Итог

В рамках лабораторной работы реализована база данных СПО «Колибри» с поддержкой добавления, удаления и поиска данных.  
Все операции выполняются через PostgreSQL с использованием SQL-скриптов и консольного интерфейса psql.
